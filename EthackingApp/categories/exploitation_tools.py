from colorama import init, Fore, Style
from modules.exploitation_tools_functions.brute_force import BruteForce
from modules.exploitation_tools_functions.password_cracking import run_password_cracking
from modules.exploitation_tools_functions.reverse_shell import run_reverse_shell
from modules.exploitation_tools_functions.packet_injection import run_packet_injection
from modules.exploitation_tools_functions.mitm_attack import run_mitm_attack
from modules.exploitation_tools_functions.ddos import DDOSAttack
import os
import subprocess

init(autoreset=True)

def clear_console():
    """Clears the terminal screen."""
    if os.name == 'nt':
        subprocess.call('cls', shell=True)
    else:
        subprocess.call('clear', shell=True)

def exploitation_tools_menu():
    """Menu for Exploitation Tools"""
    while True:
        print(f"{Style.BRIGHT}{Fore.CYAN}Exploitation Tools{Style.RESET_ALL}")
        print(f"{Fore.YELLOW}1. DOS/DDoS Attack")
        print(f"{Fore.YELLOW}2. Brute Force Attack")
        print(f"{Fore.YELLOW}3. Password Cracking")
        print(f"{Fore.YELLOW}4. Reverse Shell")
        print(f"{Fore.YELLOW}5. Packet Injection")
        print(f"{Fore.YELLOW}6. MITM Attack")
        print(f"{Fore.RED}7. Back to Main Menu")

        choice = input(f"{Fore.GREEN}Select an option: {Style.RESET_ALL}")

        if choice == "1":
            ddos = DDOSAttack()
            ddos.run()
        elif choice == "2":
            brute = BruteForce()
            brute.run()
        elif choice == "3":
            run_password_cracking()
        elif choice == "4":
            run_reverse_shell()
        elif choice == "5":
            run_packet_injection()
        elif choice == "6":
            run_mitm_attack()
        elif choice == "7":
            break
        else:
            print(f"{Fore.RED}Invalid choice.")
        
        input(f"{Fore.MAGENTA}Press Enter to return to the exploitation tools menu...{Style.RESET_ALL}")
        clear_console()
