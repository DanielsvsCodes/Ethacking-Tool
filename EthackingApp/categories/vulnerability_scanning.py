from colorama import init, Fore, Style
from EthackingApp.modules.vulnerability_scanning_functions.web_vuln_scanner import run_web_vuln_scanner
from EthackingApp.modules.vulnerability_scanning_functions.sql_injection import SQLInjection
from EthackingApp.modules.vulnerability_scanning_functions.xss_tester import run_xss_tester
from EthackingApp.modules.vulnerability_scanning_functions.file_inclusion import run_file_inclusion
from EthackingApp.modules.vulnerability_scanning_functions.encryption_checker import run_encryption_checker
import os
import subprocess

init(autoreset=True)

def clear_console():
    """Clears the terminal screen."""
    if os.name == 'nt':
        subprocess.call('cls', shell=True)
    else:
        subprocess.call('clear', shell=True)

def vulnerability_scanning_menu():
    """Menu for Vulnerability Scanning Tools"""
    while True:
        print(f"{Style.BRIGHT}{Fore.CYAN}Vulnerability Scanning Tools{Style.RESET_ALL}")
        print(f"{Fore.YELLOW}1. Web Vulnerability Scanner")
        print(f"{Fore.YELLOW}2. SQL Injection Testing")
        print(f"{Fore.YELLOW}3. XSS Tester")
        print(f"{Fore.YELLOW}4. File Inclusion Testing")
        print(f"{Fore.YELLOW}5. Encryption Checker")
        print(f"{Fore.YELLOW}6. Back to Main Menu")

        choice = input(f"{Fore.GREEN}Select an option: {Style.RESET_ALL}")

        if choice == "1":
            run_web_vuln_scanner()
        elif choice == "2":
            sql = SQLInjection()
            sql.run()
        elif choice == "3":
            run_xss_tester()
        elif choice == "4":
            run_file_inclusion()
        elif choice == "5":
            run_encryption_checker()
        elif choice == "6":
            break
        else:
            print(f"{Fore.RED}Invalid choice.")
        
        input(f"{Fore.MAGENTA}Press Enter to return to the vulnerability scanning menu...{Style.RESET_ALL}")
        clear_console()
